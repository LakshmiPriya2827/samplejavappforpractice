pipeline {
    agent any
    tools {
        maven "maven"
    }
    stages {
        stage('compile') {
           steps {
              git 'https://github.com/anveshpanjala/samplejavappforpractice.git'
              sh 'mvn compile'
           }
        }
        stage('codereview-pmd') {
           steps {
              sh 'mvn -P metrics pmd:pmd'
           }
           post {
               success {
                  recordIssues sourceCodeRetention: 'LAST_BUILD', tools: [pmdParser(pattern: '**/pmd.xml')]
                       }
                }
        }
        stage('test') {
           steps {
              sh 'mvn test'
            }
           post {
               success {
                  junit stdioRetention: '', testResults: 'target/surefire-reports/*.xml'
                  }
               }
           
        }
        stage('codecoverage') {
            steps {
                sh 'mvn verify'
            }
            post {
                success {
                    jacoco()
                    }
                }
            
        }
        stage('package') {
           steps {
              sh 'mvn package'
           }
        }
    }
}
